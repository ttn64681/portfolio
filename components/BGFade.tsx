import { motion, useTransform } from 'framer-motion';
import { useState, useEffect } from 'react';

export default function BGFade() {
  const [isVisible, setIsVisible] = useState(true);
  const [svgSize, setSvgSize] = useState({ width: 384, height: 192 });

  useEffect(() => {
    const updateSize = () => {
      if (window.innerWidth <= 640) {
        setSvgSize({ width: 256, height: 128 }); // Phone
      } else if (window.innerWidth <= 768) {
        setSvgSize({ width: 320, height: 160 }); // Tablet
      } else {
        setSvgSize({ width: 384, height: 192 }); // Desktop
      }
    };

    updateSize();
    window.addEventListener('resize', updateSize);
    return () => window.removeEventListener('resize', updateSize);
  }, []);

  useEffect(() => {
    const timer = setTimeout(() => {
      setIsVisible(false);
    }, 3000);

    return () => clearTimeout(timer);
  }, []);

  if (!isVisible) {
    return null;
  }

  return (
    <motion.div
      className='absolute top-0 left-0 w-full h-screen flex justify-center items-center z-51 bg-blackground'
      initial={{ opacity: 1 }}
      animate={{ opacity: 0, scale: 1.5 }}
      transition={{ duration: 1, delay: 1, ease: 'easeOut' }}
      style={{
        pointerEvents: 'none',
        willChange: 'transform, opacity', // For optimizing performance, GPU and such
      }}
    >
      <div
        className='relative'
        style={{
          width: `${svgSize.width}px`,
          height: `${svgSize.height}px`,
        }}
      >
        <svg
          width='501'
          height='250'
          viewBox='0 0 501 250'
          fill='none'
          xmlns='http://www.w3.org/2000/svg'
          style={{
            width: `${svgSize.width}px`,
            height: `${svgSize.height}px`,
            zIndex: 50,
            position: 'relative',
            willChange: 'transform',
            contain: 'layout style paint',
          }}
        >
          <motion.path
            d='M303.021 35L335.018 20.8144C329.407 8.1592 316.865 0 303.021 0V35ZM438.868 188.434L473.315 194.629L438.868 188.434ZM500.508 40.85C503.739 21.792 490.908 3.72325 471.85 0.492362C452.792 -2.73852 434.723 10.0919 431.492 29.15L500.508 40.85ZM35 0H0V70H35V0ZM106.034 162.967L140.432 169.431L140.432 169.431L106.034 162.967ZM277.623 176.462L243.174 170.277L243.174 170.277L277.623 176.462ZM231.549 180H196.549V250H231.549V180ZM149.2 250H184.2V180H149.2V250ZM303.021 35C271.025 49.1856 271.027 49.1899 271.029 49.1953C271.031 49.1984 271.034 49.2048 271.036 49.2111C271.042 49.2236 271.049 49.2401 271.058 49.2605C271.076 49.3014 271.102 49.3581 271.134 49.4302C271.198 49.5745 271.29 49.7808 271.409 50.0466C271.647 50.5782 271.993 51.3481 272.44 52.3369C273.334 54.3143 274.634 57.1691 276.288 60.7458C279.593 67.8945 284.324 77.9528 290.061 89.6702C301.466 112.961 317.137 143.405 333.679 170.679C341.942 184.303 350.729 197.647 359.59 209.114C368.046 220.057 378.253 231.53 389.706 239.317C400.315 246.531 423.158 257.413 446.322 242.539C464.736 230.716 470.673 209.32 473.315 194.629L438.868 188.434L404.42 182.24C402.169 194.756 400.191 188.972 408.501 183.637C421.56 175.251 432.108 183.499 429.064 181.43C426.865 179.934 422.06 175.476 414.979 166.312C408.303 157.672 401.026 146.736 393.531 134.379C378.558 109.691 363.938 81.3696 352.929 58.8869C347.46 47.7174 342.954 38.1363 339.824 31.3675C338.26 27.9855 337.043 25.312 336.224 23.5006C335.815 22.5952 335.505 21.9057 335.302 21.4515C335.2 21.2244 335.125 21.0561 335.078 20.9491C335.054 20.8956 335.037 20.8575 335.027 20.8349C335.022 20.8236 335.019 20.8163 335.017 20.8128C335.016 20.8111 335.017 20.8115 335.016 20.8107C335.017 20.8121 335.018 20.8144 303.021 35ZM438.868 188.434L473.315 194.629C483.109 140.167 489.901 101.756 494.248 76.9451C496.421 64.5394 497.983 55.533 499.003 49.6196C499.513 46.6628 499.888 44.4792 500.136 43.0304C500.26 42.306 500.352 41.7653 500.414 41.4035C500.444 41.2226 500.467 41.0864 500.483 40.9944C500.491 40.9484 500.497 40.9134 500.501 40.8893C500.503 40.8773 500.505 40.868 500.506 40.8615C500.506 40.8582 500.507 40.8556 500.507 40.8537C500.507 40.8528 500.507 40.8518 500.507 40.8514C500.508 40.8506 500.508 40.85 466 35C431.492 29.15 431.492 29.1497 431.492 29.1497C431.492 29.1499 431.492 29.15 431.492 29.1504C431.492 29.1512 431.492 29.1527 431.492 29.1549C431.491 29.1592 431.49 29.1663 431.488 29.1761C431.485 29.1958 431.479 29.2265 431.472 29.2682C431.458 29.3515 431.436 29.4791 431.407 29.6515C431.348 29.9962 431.259 30.52 431.138 31.2278C430.896 32.6434 430.527 34.7946 430.022 37.7199C429.013 43.5704 427.461 52.5168 425.298 64.8658C420.971 89.564 414.197 127.871 404.42 182.24L438.868 188.434ZM35 35V70H96.2564V35V0H35V35ZM96.2564 35V70H130.082V35V0H96.2564V35ZM130.082 35L95.6836 28.536L71.6364 156.503L106.034 162.967L140.432 169.431L164.479 41.464L130.082 35ZM303.021 35L268.572 28.8148L243.174 170.277L277.623 176.462L312.072 182.647L337.471 41.1852L303.021 35ZM130.082 35V70H216.551V35V0H130.082V35ZM216.551 35V70H303.021V35V0H216.551V35ZM277.623 176.462L243.174 170.277C242.163 175.904 237.267 180 231.549 180V215V250C271.155 250 305.073 221.63 312.072 182.647L277.623 176.462ZM106.034 162.967L71.6364 156.503C62.5077 205.081 99.7715 250 149.2 250V215V180C143.613 180 139.4 174.922 140.432 169.431L106.034 162.967Z'
            stroke='#F1F8FF'
            strokeWidth='2'
            initial={{ pathLength: 0, opacity: 0 }}
            animate={{ pathLength: 1, opacity: 1 }}
            transition={{
              pathLength: { duration: 3, ease: 'easeInOut' },
            }}
          />
        </svg>
        <svg
          width='501'
          height='250'
          viewBox='0 0 501 250'
          fill='none'
          xmlns='http://www.w3.org/2000/svg'
          style={{
            position: 'absolute',
            top: 0,
            left: 0,
            width: `${svgSize.width}px`,
            height: `${svgSize.height}px`,
            zIndex: 49,
            willChange: 'transform',
            contain: 'layout style paint',
          }}
        >
          <motion.path
            d='M303.021 35L335.018 20.8144C329.407 8.1592 316.865 0 303.021 0V35ZM438.868 188.434L473.315 194.629L438.868 188.434ZM500.508 40.85C503.739 21.792 490.908 3.72325 471.85 0.492362C452.792 -2.73852 434.723 10.0919 431.492 29.15L500.508 40.85ZM35 0H0V70H35V0ZM106.034 162.967L140.432 169.431L140.432 169.431L106.034 162.967ZM277.623 176.462L243.174 170.277L243.174 170.277L277.623 176.462ZM231.549 180H196.549V250H231.549V180ZM149.2 250H184.2V180H149.2V250ZM303.021 35C271.025 49.1856 271.027 49.1899 271.029 49.1953C271.031 49.1984 271.034 49.2048 271.036 49.2111C271.042 49.2236 271.049 49.2401 271.058 49.2605C271.076 49.3014 271.102 49.3581 271.134 49.4302C271.198 49.5745 271.29 49.7808 271.409 50.0466C271.647 50.5782 271.993 51.3481 272.44 52.3369C273.334 54.3143 274.634 57.1691 276.288 60.7458C279.593 67.8945 284.324 77.9528 290.061 89.6702C301.466 112.961 317.137 143.405 333.679 170.679C341.942 184.303 350.729 197.647 359.59 209.114C368.046 220.057 378.253 231.53 389.706 239.317C400.315 246.531 423.158 257.413 446.322 242.539C464.736 230.716 470.673 209.32 473.315 194.629L438.868 188.434L404.42 182.24C402.169 194.756 400.191 188.972 408.501 183.637C421.56 175.251 432.108 183.499 429.064 181.43C426.865 179.934 422.06 175.476 414.979 166.312C408.303 157.672 401.026 146.736 393.531 134.379C378.558 109.691 363.938 81.3696 352.929 58.8869C347.46 47.7174 342.954 38.1363 339.824 31.3675C338.26 27.9855 337.043 25.312 336.224 23.5006C335.815 22.5952 335.505 21.9057 335.302 21.4515C335.2 21.2244 335.125 21.0561 335.078 20.9491C335.054 20.8956 335.037 20.8575 335.027 20.8349C335.022 20.8236 335.019 20.8163 335.017 20.8128C335.016 20.8111 335.017 20.8115 335.016 20.8107C335.017 20.8121 335.018 20.8144 303.021 35ZM438.868 188.434L473.315 194.629C483.109 140.167 489.901 101.756 494.248 76.9451C496.421 64.5394 497.983 55.533 499.003 49.6196C499.513 46.6628 499.888 44.4792 500.136 43.0304C500.26 42.306 500.352 41.7653 500.414 41.4035C500.444 41.2226 500.467 41.0864 500.483 40.9944C500.491 40.9484 500.497 40.9134 500.501 40.8893C500.503 40.8773 500.505 40.868 500.506 40.8615C500.506 40.8582 500.507 40.8556 500.507 40.8537C500.507 40.8528 500.507 40.8518 500.507 40.8514C500.508 40.8506 500.508 40.85 466 35C431.492 29.15 431.492 29.1497 431.492 29.1497C431.492 29.1499 431.492 29.15 431.492 29.1504C431.492 29.1512 431.492 29.1527 431.492 29.1549C431.491 29.1592 431.49 29.1663 431.488 29.1761C431.485 29.1958 431.479 29.2265 431.472 29.2682C431.458 29.3515 431.436 29.4791 431.407 29.6515C431.348 29.9962 431.259 30.52 431.138 31.2278C430.896 32.6434 430.527 34.7946 430.022 37.7199C429.013 43.5704 427.461 52.5168 425.298 64.8658C420.971 89.564 414.197 127.871 404.42 182.24L438.868 188.434ZM35 35V70H96.2564V35V0H35V35ZM96.2564 35V70H130.082V35V0H96.2564V35ZM130.082 35L95.6836 28.536L71.6364 156.503L106.034 162.967L140.432 169.431L164.479 41.464L130.082 35ZM303.021 35L268.572 28.8148L243.174 170.277L277.623 176.462L312.072 182.647L337.471 41.1852L303.021 35ZM130.082 35V70H216.551V35V0H130.082V35ZM216.551 35V70H303.021V35V0H216.551V35ZM277.623 176.462L243.174 170.277C242.163 175.904 237.267 180 231.549 180V215V250C271.155 250 305.073 221.63 312.072 182.647L277.623 176.462ZM106.034 162.967L71.6364 156.503C62.5077 205.081 99.7715 250 149.2 250V215V180C143.613 180 139.4 174.922 140.432 169.431L106.034 162.967Z'
            fill='#F1F8FF'
            initial={{ clipPath: 'polygon(0 0, 0 0, 0 0)', opacity: 0 }}
            animate={{ clipPath: 'polygon(0 0, 0 100%, 100% 100%)', opacity: 1 }}
            transition={{
              clipPath: { duration: 0.5, ease: 'easeInOut', delay: 0.25 },
            }}
          />
        </svg>
      </div>
    </motion.div>
  );
}
